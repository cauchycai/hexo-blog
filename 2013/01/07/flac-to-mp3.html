<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>flac文件分割并转成mp3的一个脚本</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Thinking Aloud</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>flac文件分割并转成mp3的一个脚本</h2>
<p class="meta">07 Jan 2013</p>

<div class="post">
<p>bash脚本：flac<em>to</em>mp3</p>

<pre>
#!/bin/sh
if [ $# -lt 3 ]
then
        echo "Usage: $0 example.cue example.flac destDir"
        exit 1
fi

cue_file=$1
audio_file=$2
dest_dir=$3
mkdir -p "$dest_dir"
echo "Export files to $dest_dir"

shntool split -t "%n.%t" -f "$cue_file" -o 'cust ext=mp3 lame --r3mix -b 320 --quiet - %f' "$audio_file" -d "$dest_dir"

echo "Writing id3 info..."
track_count=`cueprint -d '%N' "$cue_file"`
track_index=1
while [ $track_index -le $track_count ]
do
        artist=`cueprint -n$track_index -t '%p' "$cue_file"`
        album=`cueprint -n$track_index -t '%T' "$cue_file"`
        tracknum=`cueprint -n$track_index -t '%02n' "$cue_file"`
        title=`cueprint -n$track_index -t '%t' "$cue_file"`
        mid3v2 --artist="$artist" --album="$album" --track="$tracknum" --song="$title" "$dest_dir/$tracknum.$title.mp3"
        track_index=$(expr $track_index + 1 )
done
</pre>

<p>
使用：flac\<sub>to\</sub><sub>mp3</sub> example.cue example.flac destDir
</p>

<p>
cue文件如果不是utf-8编码的必须转成utf-8编码。
</p>

<p>
脚本中用到的一些命令需要预先安装下列程序：flac,shntool,lame,cuetools,mutagen。
</p>

</div>


          <div class="footer">
            <div class="contact">
              <p>
                Cauchy Cai<br />
                A Programmer<br />
                cauchy.cai@gmail.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/cauchycai">github.com/cauchycai</a><br />
                <a href="https://twitter.com/cauuuuchy">twitter.com/cauuuuchy</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
