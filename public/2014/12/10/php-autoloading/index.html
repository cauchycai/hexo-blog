<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>PHP Autoloading | 追客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/app.css">
  <!-- <link rel='stylesheet' href='http://fonts.useso.com/css?family=Source+Code+Pro'> -->
</head>

<body>
  <nav class="app-nav">
  
    
      <a href="/.">home</a>
    
  
    
      <a href="/archives">archive</a>
    
  
    
      <a href="/about">about</a>
    
  
    
      <a href="/atom.xml">rss</a>
    
  
</nav>

  <main class="post">
  <article>
  <h1 class="article-title">
    <a href="/2014/12/10/php-autoloading/">PHP Autoloading</a>
  </h1>

  <section class="article-meta">
    <p class="article-date">December 10 2014</p>
  </section>

  <section class="article-entry">
    <h1 id="解决的问题"><a href="#解决的问题" class="headerlink" title="解决的问题"></a>解决的问题</h1><p>Autoloading机制是php5引入的特性。<br>一个类的实现可能需要依赖很多其他类，这就需要要么在脚本开始的地方引用所有基础类，要么在每个类的地方手动写上很长的一段类的引用。<br>使用autoloading可以利用php运行环境来自动引用需要的类文件。</p>
<p>使用上主要是用到了__autoload函数或者 spl_autoload_register</p>
<h1 id="spl-autoload-register"><a href="#spl-autoload-register" class="headerlink" title="spl_autoload_register"></a>spl_autoload_register</h1><p>支持多个autoload方法/函数, 多个不同autoload方法可以用来支持自动require多个不同目录位置的类。</p>
<h2 id="类方法作为注册为autoload函数"><a href="#类方法作为注册为autoload函数" class="headerlink" title="类方法作为注册为autoload函数"></a>类方法作为注册为autoload函数</h2><figure class="highlight plain"><figcaption><span>php</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">class Autoloader</div><div class="line">&#123;</div><div class="line">	private $dir;</div><div class="line">	public function __construct($dir = null)</div><div class="line">	&#123;</div><div class="line">		if (is_null($dir)) &#123;</div><div class="line">			$dir = dirname(__FILE__).&apos;/..&apos;;</div><div class="line">		&#125;</div><div class="line">		$this-&gt;dir = $dir;</div><div class="line">	&#125;</div><div class="line">	public static function register($dir = null)</div><div class="line">	&#123;</div><div class="line">		ini_set(&apos;unserialize_callback_func&apos;, &apos;spl_autoload_call&apos;);</div><div class="line">		spl_autoload_register(array(new self($dir), &apos;autoload&apos;));</div><div class="line">	&#125;</div><div class="line">	public function autoload($class)</div><div class="line">	&#123;</div><div class="line">		if (file_exists($file = $this-&gt;dir.&apos;/&apos;.str_replace(&apos;\\&apos;, &apos;/&apos;, $class).&apos;.php&apos;)) &#123;</div><div class="line">			require $file;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="具体使用"><a href="#具体使用" class="headerlink" title="具体使用"></a>具体使用</h2><figure class="highlight plain"><figcaption><span>php</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">require_once PATH_TO_AUTOLOAD_CLASS;</div><div class="line">$loader = new Autoloader();</div><div class="line">$loader-&gt;register(HELPER_PATH);</div><div class="line">$loader-&gt;register(MODEL_PATH);</div></pre></td></tr></table></figure>
<h1 id="psr-4"><a href="#psr-4" class="headerlink" title="psr-4"></a>psr-4</h1><p>“PHP Framework Interop Group” 这个组织定义的Autoloading实现规范。</p>
<p><a href="http://www.php-fig.org/psr/psr-4/" target="_blank" rel="external">http://www.php-fig.org/psr/psr-4/</a></p>
<h2 id="合法的类名"><a href="#合法的类名" class="headerlink" title="合法的类名"></a>合法的类名</h2><pre><code>\&lt;NamespaceName&gt;(\&lt;SubNamespaceNames&gt;)*\&lt;ClassName&gt;
</code></pre><ol>
<li>必须有一个顶级namespace, 这个namespace也被称为 “vendor namespace”;</li>
<li>可以有一个或多个 sub-namespace;</li>
<li>结尾处必须有一个类的名字</li>
<li>下划线(_)没有特殊的意义(不同于psr-0)</li>
<li>名字中大小写组合无限制</li>
<li>字母大小写敏感</li>
</ol>
<h2 id="根据类名来选择include哪个php文件"><a href="#根据类名来选择include哪个php文件" class="headerlink" title="根据类名来选择include哪个php文件"></a>根据类名来选择include哪个php文件</h2><ol>
<li>顶级namespace对应到一个base目录</li>
<li>sub-namespace逐级对应base目录下的子目录</li>
<li>结尾处类名对应到<classname>.php文件</classname></li>
</ol>
<h1 id="使用autoloading的坏处"><a href="#使用autoloading的坏处" class="headerlink" title="使用autoloading的坏处"></a>使用autoloading的坏处</h1><p>没法显示的看到require的顺序，给调试带来不便。</p>

  </section>
</article>

  <div class="sharing grid">
  <section class="profile grid-item grid">
    <img class="avatar" src="http://7xrcp8.com1.z0.glb.clouddn.com/avatar.png" alt="avatar" />
    <div class="grid-item">
      <p class="title"> 追客 </p>
      <p class="subtitle"> You are the JavaScript in my HTML </p>
    <div>
  </section>

  <section class="share-btns">
    <!-- <p> share it if you like it~ </p> -->
    <a
  class="twitter-share-button"
  data-size="large"
  data-via="DrakeLeung"
  href="https://twitter.com/intent/tweet?text= id="解决的问题"><a href="
>
  Tweet
</a>

<script>
  window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  js.async = true;
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));
</script>

  </section>
</div>


  
    
<section class="article-comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

<script>
  var disqus_shortname = 'drakeleung';
  
  var disqus_url = 'http://www.cauchy.me/2014/12/10/php-autoloading/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


  
</main>

</body>
</html>
